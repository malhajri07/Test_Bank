{% load i18n %}
<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>{% trans "Invoice" %} #{{ payment.id }} — Exam Stellar</title>
</head>
<body style="margin:0;padding:0;background-color:#f0f2f5;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;">
    <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="background-color:#f0f2f5;">
        <tr><td align="center" style="padding:40px 16px;">
            <table role="presentation" width="600" cellpadding="0" cellspacing="0" style="max-width:600px;width:100%;background-color:#ffffff;border-radius:16px;overflow:hidden;box-shadow:0 2px 12px rgba(0,0,0,0.08);">

                <!-- Header -->
                <tr>
                    <td style="background:linear-gradient(135deg,#5624d0 0%,#3b10a0 100%);padding:32px;">
                        <table role="presentation" width="100%" cellpadding="0" cellspacing="0">
                            <tr>
                                <td style="font-size:24px;font-weight:700;color:#ffffff;">
                                    {ES} Exam Stellar
                                </td>
                                <td style="text-align:right;font-size:14px;color:rgba(255,255,255,0.85);">
                                    {% trans "Invoice" %}
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <!-- Invoice meta -->
                <tr>
                    <td style="padding:28px 32px 0;">
                        <table role="presentation" width="100%" cellpadding="0" cellspacing="0">
                            <tr>
                                <td style="vertical-align:top;">
                                    <p style="margin:0 0 4px;font-size:12px;color:#999;text-transform:uppercase;letter-spacing:1px;">{% trans "Invoice Number" %}</p>
                                    <p style="margin:0 0 16px;font-size:18px;font-weight:700;color:#1a1a2e;">#{{ payment.id }}</p>
                                </td>
                                <td style="text-align:right;vertical-align:top;">
                                    <p style="margin:0 0 4px;font-size:12px;color:#999;text-transform:uppercase;letter-spacing:1px;">{% trans "Date" %}</p>
                                    <p style="margin:0;font-size:14px;color:#1a1a2e;font-weight:500;">{{ payment.created_at|date:"F d, Y" }}</p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <!-- Status badge -->
                <tr>
                    <td style="padding:0 32px 24px;">
                        <span style="display:inline-block;background-color:#ecfdf5;color:#059669;padding:4px 14px;border-radius:20px;font-size:12px;font-weight:600;border:1px solid #a7f3d0;">
                            ✓ {% trans "PAID" %}
                        </span>
                    </td>
                </tr>

                <!-- Bill To -->
                <tr>
                    <td style="padding:0 32px 20px;">
                        <p style="margin:0 0 4px;font-size:12px;color:#999;text-transform:uppercase;letter-spacing:1px;">{% trans "Billed To" %}</p>
                        <p style="margin:0;font-size:15px;color:#1a1a2e;font-weight:600;">{{ payment.user.get_full_name|default:payment.user.username }}</p>
                        <p style="margin:2px 0 0;font-size:13px;color:#777;">{{ payment.user.email }}</p>
                    </td>
                </tr>

                <!-- Divider -->
                <tr><td style="padding:0 32px;"><hr style="border:none;border-top:1px solid #eee;margin:0;"></td></tr>

                <!-- Line items header -->
                <tr>
                    <td style="padding:20px 32px 0;">
                        <table role="presentation" width="100%" cellpadding="0" cellspacing="0">
                            <tr>
                                <td style="font-size:11px;color:#999;text-transform:uppercase;letter-spacing:1px;padding-bottom:8px;border-bottom:2px solid #eee;">
                                    {% trans "Description" %}
                                </td>
                                <td style="text-align:right;font-size:11px;color:#999;text-transform:uppercase;letter-spacing:1px;padding-bottom:8px;border-bottom:2px solid #eee;width:100px;">
                                    {% trans "Amount" %}
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <!-- Line item: Test Bank -->
                <tr>
                    <td style="padding:0 32px;">
                        <table role="presentation" width="100%" cellpadding="0" cellspacing="0">
                            <tr>
                                <td style="padding:16px 0;border-bottom:1px solid #f0f0f0;vertical-align:top;">
                                    <p style="margin:0 0 4px;font-size:15px;font-weight:600;color:#1a1a2e;">
                                        {{ payment.test_bank.title }}
                                    </p>
                                    <p style="margin:0;font-size:12px;color:#999;">
                                        {% trans "Test Bank Access — Lifetime" %}
                                    </p>
                                    {% if payment.test_bank.category %}
                                    <p style="margin:4px 0 0;font-size:11px;color:#aaa;">
                                        {% trans "Category:" %} {{ payment.test_bank.category.name }}
                                    </p>
                                    {% endif %}
                                </td>
                                <td style="text-align:right;padding:16px 0;border-bottom:1px solid #f0f0f0;vertical-align:top;font-size:15px;color:#1a1a2e;font-weight:500;width:100px;">
                                    ${{ payment.get_net_price|floatformat:2 }}
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <!-- Subtotal / VAT / Total -->
                <tr>
                    <td style="padding:0 32px;">
                        <table role="presentation" width="100%" cellpadding="0" cellspacing="0">
                            <!-- Subtotal -->
                            <tr>
                                <td style="padding:12px 0 4px;font-size:13px;color:#777;">{% trans "Subtotal" %}</td>
                                <td style="text-align:right;padding:12px 0 4px;font-size:13px;color:#777;width:100px;">
                                    ${{ payment.get_net_price|floatformat:2 }}
                                </td>
                            </tr>
                            <!-- VAT -->
                            <tr>
                                <td style="padding:4px 0;font-size:13px;color:#777;">
                                    {% trans "VAT" %} ({{ payment.get_vat_rate_percent }}%)
                                </td>
                                <td style="text-align:right;padding:4px 0;font-size:13px;color:#777;width:100px;">
                                    ${{ payment.get_vat_amount|floatformat:2 }}
                                </td>
                            </tr>
                            <!-- Total -->
                            <tr>
                                <td style="padding:16px 0 0;font-size:17px;font-weight:700;color:#1a1a2e;border-top:2px solid #1a1a2e;">
                                    {% trans "Total Paid" %}
                                </td>
                                <td style="text-align:right;padding:16px 0 0;font-size:20px;font-weight:700;color:#5624d0;border-top:2px solid #1a1a2e;width:100px;">
                                    ${{ payment.get_total_amount|floatformat:2 }}
                                    <span style="font-size:12px;color:#999;font-weight:400;">{{ payment.currency|upper }}</span>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <!-- Payment details -->
                <tr>
                    <td style="padding:24px 32px 0;">
                        <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="background-color:#f8f9fa;border-radius:8px;">
                            <tr><td style="padding:16px 20px;">
                                <p style="margin:0 0 8px;font-size:12px;color:#999;text-transform:uppercase;letter-spacing:1px;">{% trans "Payment Details" %}</p>
                                <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="font-size:13px;">
                                    <tr>
                                        <td style="color:#777;padding:4px 0;width:120px;">{% trans "Method" %}</td>
                                        <td style="color:#1a1a2e;padding:4px 0;font-weight:500;">{{ payment.get_payment_provider_display }}</td>
                                    </tr>
                                    {% if payment.provider_payment_id %}
                                    <tr>
                                        <td style="color:#777;padding:4px 0;">{% trans "Transaction ID" %}</td>
                                        <td style="color:#1a1a2e;padding:4px 0;font-weight:500;font-family:'Courier New',monospace;font-size:12px;">{{ payment.provider_payment_id }}</td>
                                    </tr>
                                    {% endif %}
                                    <tr>
                                        <td style="color:#777;padding:4px 0;">{% trans "Date & Time" %}</td>
                                        <td style="color:#1a1a2e;padding:4px 0;font-weight:500;">{{ payment.created_at|date:"F d, Y — g:i A" }}</td>
                                    </tr>
                                </table>
                            </td></tr>
                        </table>
                    </td>
                </tr>

                <!-- CTA Button -->
                <tr>
                    <td style="padding:28px 32px;text-align:center;">
                        <a href="{{ site_url }}{% url 'catalog:testbank_detail' slug=payment.test_bank.slug %}" style="display:inline-block;background:linear-gradient(135deg,#5624d0,#3b10a0);color:#ffffff;padding:14px 32px;text-decoration:none;border-radius:8px;font-weight:600;font-size:15px;box-shadow:0 4px 12px rgba(86,36,208,0.3);">
                            {% trans "Start Practicing Now" %}
                        </a>
                        <p style="margin:12px 0 0;font-size:13px;color:#999;">
                            {% trans "You now have full access to this test bank." %}
                        </p>
                    </td>
                </tr>

                <!-- Footer -->
                <tr>
                    <td style="background-color:#f8f9fa;padding:24px 32px;text-align:center;">
                        <p style="margin:0 0 8px;font-size:12px;color:#999;">
                            {% trans "This is an automated invoice from Exam Stellar." %}
                        </p>
                        <p style="margin:0 0 12px;font-size:12px;color:#999;">
                            <a href="{{ site_url }}" style="color:#5624d0;text-decoration:none;">{% trans "Website" %}</a> &nbsp;·&nbsp;
                            <a href="{{ site_url }}{% url 'catalog:contact' %}" style="color:#5624d0;text-decoration:none;">{% trans "Support" %}</a>
                        </p>
                        <p style="margin:0;font-size:11px;color:#ccc;">&copy; {% now "Y" %} Exam Stellar. {% trans "All rights reserved." %}</p>
                    </td>
                </tr>

            </table>
        </td></tr>
    </table>
</body>
</html>
